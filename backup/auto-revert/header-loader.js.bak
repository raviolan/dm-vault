// header-loader.js
(function () {
    async function render() {
        try {
            // Prefer existing top container; if not present, try to insert before main
            let root = document.querySelector('.top');
            const layout = document.querySelector('.layout');
            if (!root && layout) {
                root = document.createElement('div');
                root.className = 'top';
                layout.insertBefore(root, layout.firstChild);
            }
            if (!root) return;
            // If the toolbar already exists, assume header provided per-page and do nothing
            if (root.querySelector('.toolbar')) return;
            const res = await fetch('/assets/partials/header.html', { cache: 'no-store' });
            if (!res.ok) return;
            const html = await res.text();
            root.innerHTML = html;
        } catch (e) {
            console.debug('header-loader: failed to load partial', e);
        }
    }
    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', render); else render();
})();
